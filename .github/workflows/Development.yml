
# Code vulnerabilities check
name: Development
on:
  push:
    branches:
      - main
  pull_request:
  schedule:
    - cron: '56 5 * * 1'
  workflow_call:

jobs:
  analyze:
    name: Analyze
    runs-on: windows-latest
    strategy:
      fail-fast: false

    env:
      sln-file: DotNetApp.sln

    steps:
      - uses: actions/checkout@v3
      
      # Run NuGet restore for each project/solution to analyze
      - name: Run NuGet restore
        run: dotnet restore
      
      # Run code analysis for all projects/solutions, such that code analysis violations break the build.
      - name: Run .NET Code Analysis
        uses: dotnet/code-analysis@v1
        id: code-analysis
        with:
          solution: ${{env.sln-file}}
          build-breaking: true
          all-categories: all
